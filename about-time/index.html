<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>It's about Time !</title>

    <link href="https://fonts.googleapis.com/css?family=Exo+2" rel="stylesheet">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/black.css">
    <link rel="stylesheet" href="css/custom.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/solarized-light.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section>
            <section>
                <h1>It's about Time !</h1>
            </section>
            <section>
                <img class="fragment" src="assets/tardis.jpg" alt="Tardis" width="33%">
                <img class="fragment" src="assets/DeLorean.jpg" alt="DeLorean" width="33%">
                <img class="fragment" src="assets/old-lady.jpg" alt="Granny" width="33%">
                <aside class="notes">
                    En mission,arrive un moment o√π on doit g√©rer du temps.
                    Souvent mal fait : ex: Alibeez (cong√©s aec p√©riode √† cheval 2 mois)
                    Autre cas, RATP avec les journ√©es de 4h30 √† 2h30 du matin
                    ou EDF avec DST. ou fuseau horaire.

                    Angular pour dashboard du Tardis.
                    (ou l'arbre g√©n√©alogique de votre grand-m√®re)
                </aside>
            </section>
            <section>
                <h1>Le temps ?</h1>
                <aside class="notes">
                    Notion ancienne, mesure universelle, relative, politique, √©conomique.
                </aside>
            </section>
            <section>
                <img src="assets/ntm.png" alt="NTM">
                <h2 class="fragment">Nycth√©m√®re</h2>
                <aside class="notes">
                    P√©riode d'une nuit et d'un jour
                </aside>
            </section>
            <section>
                <h2>Jour, ann√©e, mois</h2>
                <ul>
                    <li>3000 av JC, M√©sopotamie : 12 mois de 30 jours + 1 mois d'ajustement</li>
                    <li>2000 av JC, Egypte : Calendrier solaire avec 365 jours</li>
                </ul>
                <aside class="notes">
                    Assyriens : 6 veilles / J ou nuit ~2h
                </aside>
            </section>
            <section>
                <h2>Heure, minute</h2>
                <ul>
                    <li>-1350, Egypte : Clepsydre, 12h par jour et par nuit</li>
                    <li class="fragment">-500 : Heure temporaire <br>
                        <img class="fragment" src="assets/heuretemp.gif" alt="Heure temporaire" width="30%">
                    </li>
                    <li class="fragment">1300 : Heure equinoxiale</li>
                </ul>
                <aside class="notes">
                    Heure temp: Babylone 12 h, minute= 1h / 60, puis civilisations greco-romaines, cadrans solaires
                    Heure equinoxiale avec horloge m√©canique, calcul√©e en divisant en 24 la dur√©e
                    en 2 passages du soleil en un lieu √† midi. Variation entre 23h59m39 et 24h00m30
                </aside>
            </section>
            <section>
                <h2>Seconde</h2>
                <ul>
                    <li>1889 : Conf√©rence g√©n√©rale des poids et des mesures - 1/86400 du jour solaire moyen</li>
                    <li>1967 : Unit√© SI - 9 192 631 770 p√©riodes de la radiation correspondant √† la transition entre les
                        deux niveaux hyperfins de l‚Äô√©tat fondamental de l‚Äôatome de c√©sium 133
                    </li>
                </ul>
                <aside class="notes">
                    en 1956, d√©finie comme une division de l'ann√©e tropique (solaire) 1900
                </aside>
            </section>
        </section>

        <section>
            <section>
                <h1>Calendrier</h1>
            </section>
            <section>
                <h3>Adoption du calendrier Gr√©gorien proleptique</h3>
                <ul>
                    <li>Calendrier julien : 365,25 j => d√©calage de 10j</li>
                    <li>Calendrier gr√©gorien : nouvelle definition ann√©e bissextile</li>
                    <li>Le 4 octobre 1582 suivit par le 15 octobre 1582</li>
                </ul>
                <aside class="notes">
                    Du fait de la suppression de dix jours, sainte Th√©r√®se d'√Åvila est morte dans la nuit du 4 au 15
                    octobre 1582.
                </aside>
            </section>
            <section>
                <h3>Mais ...</h3>
                <ul class="fragment">
                    <li>tous les pays n'ont pas chang√© en m√™me temps</li>
                    <li>La France en d√©cembre 1582</li>
                    <li>La Grande-Bretagne et ses possessions en 1752</li>
                </ul>

                <aside class="notes">
                    Politique et guerre de religion (surtout catholique, orthodoxes, protestants)
                    William Shakespeare et Miguel de Cervantes sont morts √† la m√™me date (23 avril 1616), mais pas
                    pendant la m√™me journ√©e.
                    La R√©volution d'Octobre a eu lieu en novembre 1918.
                </aside>
            </section>
        </section>
        <section>
            <section>
                <h1>Quelle heure est-il ?</h1>

                <aside class="notes">
                    Quand ? mais aussi o√π ?
                </aside>
            </section>
            <section>
                <h2>Heure au 19e si√®cle</h2>
                <ul>
                    <li>
                        Les grandes villes ont leur propre heure equinoxiale. <br>
                        Ex: Rennes avait un d√©calage de 17 minutes avec Paris
                    </li>
                    <li>Le d√©veloppement du chemin de fer n√©cessite une uniformisation du temps</li>
                    <li>1891 : la France adopte l'heure de Paris.</li>
                </ul>

            </section>
            <section>
                <img src="assets/hoursUSA.jpg" alt="hoursUSA Chart" width="80%">
            </section>
            <section>
                <h2>Heure en France, la suite</h2>
                <ul>
                    <li>1911 - Heure GMT-9min21s</li>
                    <li>1923 - GMT + heure d'√©t√©</li>
                    <li>1940 - Sous l'Occupation GMT+1</li>
                    <li>1945 - Lib√©ration GMT+1</li>
                    <li>1976 - Choc p√©trolier, heure d'√©t√©</li>
                </ul>
                <aside class="notes">
                    1940, seulement zone occup√©e au d√©but, puis zone libre pour raisons pratiques
                    1945, Heure d'√©t√©, puis passage √† l'hiver abandonn√©.
                </aside>
            </section>
        </section>
        <section>
            <section>
                <img src="assets/rushing.gif" alt="rushing or dragging" width="100%">
                <aside class="notes">
                    secondes intercalaires d√ªes au ralentissement de la Terre
                    mar√©es, tremblements de terre peuvent affecter la rotation
                    Pas eu d'acc√©l√©ration encore.
                </aside>
            </section>
            <section>
                <h2>TAI, UTC, Unix Time</h2>
                <ul>
                    <li class="fragment">Temps Atomique Universel, d√©fini en 1967, mesure stricte du temps</li>
                    <li class="fragment">UTC - Temps Universel Coordonn√©, comme le TAI mais avec les secondes
                        intercalaires
                    </li>
                    <li class="fragment">Unix Time, Epoch , POSIX Time <br>
                        Nombre de secondes √©coul√©es depuis le 1er janvier 1970 √† 00:00:00 UTC
                        avec les secondes intercalaires
                    </li>
                </ul>

                <span class="fragment">Au 02/03/2020, TAI - UTC = 37s</span>

                <aside class="notes">

                    TAI : lin√©aire
                    UTC et Unix : non-lin√©aire
                </aside>
            </section>
            <section>
                <table>
                    <thead>
                    <td>TAI</td>
                    <td>UTC</td>
                    <td>Unix</td>
                    </thead>
                    <tbody>
                    <tr>
                        <td>2017-01-01 00:00:35</td>
                        <td>2016-12-31 23:59:59</td>
                        <td>1483228799</td>
                    </tr>
                    <tr>
                        <td>2017-01-01 00:00:36</td>
                        <td>2016-12-31 23:59:<span class="fragment highlight-green">60</span></td>
                        <td>1483228800</td>
                    </tr>
                    <tr>
                        <td>2017-01-01 00:00:37</td>
                        <td>2017-01-01 00:00:00</td>
                        <td>1483228<span class="fragment highlight-red">800</span></td>
                    </tr>
                    </tbody>
                </table>
                <aside class="notes">
                    Les secondes intercalaires sont annonc√©es 6 mois √† l'avance et parfois
                    seulement impl√©ment√©es 24h avant selon les syst√®mes.
                    Bug : Hadoop, appli Java, MySql, Kernel Linux non patch√©s, Cassandra
                    En 2012, Reddit, Gawker, Mozilla...
                </aside>
            </section>
        </section>
        <section>
            <section>
                <img src=assets/World_Time_Zones_Map.png alt="Fuseaux horaires">
                <aside class="notes">
                    Terre divis√©e en 24 fuseaux (15¬∞)
                    Pas toujours cal√© sur l'heure solaire (France)
                    1 seul fuseau pour la Chine
                    Pas que pas h, ni 1/2h, ni 1/4h (Teheran +3:30, Nepal +5:45)
                    France 12 fuseaux
                </aside>
            </section>
            <section>
                <img src="assets/indiana-county-map.png" alt="Indiana" width="40%">
                <div>Indiana</div>
            </section>
            <section>
                <h2>Heure d'√©t√©</h2>
                <h3>Daylight Saving Time</h3>
                <ul>
                    <li class="fragment">Tous les pays ne la suivent pas.</li>
                    <li class="fragment">Les pays qui la suivent ne changent pas tous en m√™me temps.</li>
                    <li class="fragment">Un pays qui suit le DST peut d√©cider de ne plus le suivre.</li>
                    <li class="fragment">Des r√©gions peuvent d√©cider de ne pas suivre le pays sur le DST.</li>
                </ul>

                <aside class="notes">
                    Les pays proches de l'√©quateur ne la suivent souvent pas.
                    Les US/ Canada changent au 1er dimanche de nov alors que l'UE dernier dimanche d'octobre.
                    Au Maroc, avant 2018, les dates variaient tous les ans, sauf Ramadan.
                    Depuis, heure d'√©t√© permanente, sauf Ramadan.
                </aside>
            </section>
            <section>
                <img src="assets/DST.png" alt="Heure d'√©t√©">
                <div class="legend">
                    <span class="legend-square blue-square"></span>
                    R√©gions observant l'heure d'√©t√©
                    <span class="legend-square orange-square"></span>
                    R√©gions ayant un certain temps observ√© l'heure d'√©t√©
                    <span class="legend-square red-square"></span>
                    R√©gions n'ayant jamais observ√© l'heure d'√©t√©
                </div>
                <aside class="notes">
                    Arizona ne suit pas, mais la Nation Navajo la suit, mais les Hopi ne la suivent pas
                </aside>
            </section>
            <section>
                <h2>tz database</h2>
                <ul>
                    <li>consigne tous les changements</li>
                    <li>domaine public</li>
                    <li>maintenue par une personne √† l'ICANN / IANA</li>
                </ul>
            </section>
        </section>
        <section>
            <section>
                <h2>Norme ISO 8601</h2>
                <ul>
                    <li>Date : 2020-03-02T14:20:00+0100 ou 2020-03-02T13:20:00Z</li>
                    <li>Intervalle : 2020-03-02T14:00/30</li>
                    <li>Dur√©e : PT4M35S</li>
                </ul>
                <aside class="notes">
                    Z = M√©ridien 0 , Zulu
                    Dur√©e, utilis√©e par ex dans l'IV
                </aside>
            </section>
        </section>
        <section>
            <section>
                <img src="assets/Indonesia.png" alt="Indon√©sie">
                <h3>UTC+7 <span class="fragment">- Java</span></h3>
            </section>
            <section>
                <h2>Depuis Java 1.1</h2>
                <ul>
                    <li>java.util.Date, java.sql.Date</li>
                    <li>java.util.Calendar</li>
                    <li>java.text.SimpleDateFormat</li>
                </ul>
            </section>
            <section>
                <pre><code class="hljs java" data-trim>
        import java.util.Calendar;
        import java.util.Date;

        // Date init
        Calendar cal = Calendar.getInstance();
        cal.set(2020, 11, 1);
        Date maybeFirstNovember = cal.getTime();
        // maybeFirstNovember: Tue Dec 01 21:31:53 CET 2020

        // Date manipulation
        cal.setTime(maybeFirstNovember);
        cal.add(Calendar.DATE, 24);
        Date xmas = cal.getTime();
        // xmas:  Fri Dec 25 21:31:53 CET 2020

        // Mutable
        maybeFirstNovember.setDate(25);
        // maybeFirstNovember: Fri Dec 25 21:31:53 CET 2020

                </code></pre>
            </section>
            <section>
                <pre><code class="hljs java" data-trim>
        import java.text.ParseException;
        import java.text.SimpleDateFormat;

        public class DateCalendarUtils {

            private static SimpleDateFormat sdf =
                    new SimpleDateFormat("yyyy-MM-dd");

            public String parse(String string) {
                try {
                    return sdf.parse(string).toString();
                } catch (ParseException e) {
                    e.printStackTrace();
                    return "error";
                }
            }
        }
                </code></pre>
            </section>
            <section>
                <h3>Ne plus utiliser java.util.Date et autres</h3>
                <ul>
                    <li>API incompr√©hensible</li>
                    <li>Date mutable</li>
                    <li>SimpleDateFormat et Calendar non thread-safe</li>
                    <li>Timestamp pas unique</li>
                </ul>
                <img src="assets/disguted.gif" alt="Rosa disgusted">
            </section>
            <section>
                <h2>Joda Time</h2>
                <ul>
                    <li>Cr√©√© par Stephen Coleman</li>
                    <li>Recommand√© pour tout code Java < 8</li>
                    <li>D√©sormais en maintenance.</li>
                </ul>
            </section>
            <section>
                <h2>Java 8 - Date/Time API</h2>
                <ul>
                    <li>JSR 310</li>
                    <li>Formatage et manipulation, quasi la m√™me API que Joda Time</li>
                    <li>Java Time Scale : 1s = 1 jour calendaire / 86400 <br>diff√©rent de 1s SI</li>
                </ul>
            </section>
            <section>
                <ul>
                    <li>LocalDate, LocalDateTime, LocalTime : date du calendrier (ex: anniversaire)</li>
                    <li>Instant : point pr√©cis dans le temps (mesur√© en s et ns depuis Epoch avec Jave Time Scale)</li>
                    <li>Duration : dur√©e, quantit√© de temps en s et ns</li>
                </ul>
            </section>
            <section>
                <svg class="date8" width="100%" height="600" viewBox="0 0 1400 600">
                    <text x="10" y="50" class="iso">2020-03-02T14:25:05.666+01:00</text>
                    <line x1="10" x2="400" y1="80" y2="80"></line>
                    <text x="10" y="140">LocalDate</text>

                    <line x1="10" x2="825" y1="180" y2="180"></line>
                    <text x="10" y="240">LocalDateTime</text>

                    <line x1="10" x2="1050" y1="280" y2="280"></line>
                    <text x="10" y="340" class="instant">OffsetDateTime</text>

                    <line x1="10" x2="825" y1="380" y2="380"></line>
                    <text x="10" y="440" class="instant">ZonedDateTime</text>
                    <text x="850" y="400" class="small"> Europe/Paris - UTC+1</text>
                    <text x="850" y="445" class="small"> (ZoneId - Zone Offset)</text>

                    <text x="0" y="540" class="small instant">Instant</text>
                </svg>
            </section>
            <section>
                <ul>
                    <li>Pour la sauvegarde en BDD, utiliser OffsetDateTime ou Instant</li>
                    <li>Faire une classe utilitaire exclusivement d√©di√©e aux dates</li>
                    <li>ZoneRules est bas√© sur tz database, MAJ √† chaque version</li>
                </ul>
            </section>
            <section>
                <h3>Comment fixer une Date dans ses tests</h3>
                <div class="dualcode">
                <pre><code class="hljs java" data-trim>
    import java.time.Clock;
    import java.time.LocalDateTime;

    public class Java8Time {

        private Clock clock;

        public Java8Time(Clock clock) {
            this.clock = clock;
        }

        public LocalDateTime now() {
            return LocalDateTime.now(clock);
        }
    }
                </code></pre>
                    <pre><code class="hljs java" data-trim>
    import java.time.Clock;
    import java.time.Instant;
    import java.time.ZoneId;

    private Java8Time sut;

    @BeforeEach
    void setUp() {
        // Fix the time !
      Clock clock =Clock.fixed(
        Instant.parse("2020-03-02T14:30:00Z"),
        ZoneId.of("Europe/Paris")
      );
      sut = new Java8Time(clock);

    }
                </code></pre>
                </div>
            </section>
        </section>
        <section>
            <section>
                <h1>Moment.js</h1>

                <aside class="notes">
                    API Date JS pas tr√®s utilisable
                </aside>
            </section>
            <section>
                <h2>Taille</h2>
                <img src="assets/moment-webpack.png" alt="Moment.js">
            </section>
            <section>
                <h3>Moment mutable</h3>
                <pre><code class="hljs javascript" data-trim>
        import * as mt from 'moment';

        const m1 = mt();
        // Bad
        const m2 = m1.subtract(3, 'months');

        // Good
        const m2 = mt(m1).subtract(3, 'months');
                </code></pre>
            </section>
            <section>
                <h2>Alternatives</h2>
                A choisir en fonction de ses besoins de rapidit√©, de formatage, de manipulation de date et de
                compatibilit√© browsers
                <br>
                <ul>
                    <li>Luxon</li>
                    <li>date-fns</li>
                    <li>day.js</li>
                    <li>Intl</li>
                </ul>
            </section>
        </section>
        <section>
            <section>
                <ul>
                    <li>Il y a toujours 24h dans une journ√©e.</li>
                    <li>Un timestamp Unix permet de s'assurer de l'unicit√©.</li>
                    <li>Je peux manipuler des dates locales sans soucis vu que mon application n'est utilis√©e qu'en
                        France.
                    </li>
                    <li>Il n'a jamais eu de 30 f√©vrier.</li>
                    <li>Le 35 Mai n'existe pas</li>
                    <li>Les ann√©es non-bissextiles ne peuvent pas avoir de jour en plus.</li>
                    <li>C'est pas grave d'utiliser java.util.Date, √ßa fait le boulot.</li>
                    <li>√Ä tout moment sur Terre, il n'y a qu'une ou deux dates en m√™me temps.</li>
                    <li>Le temps, c'est pas compliqu√©.</li>
                    <li>Je porte des chaussettes ü¶ì</li>
                </ul>
            </section>
            <section>
                <h3>Sources</h3>
                <ul>
                    <li>
                        Falsehoods programmers believe about time - Noah Sussman
                        http://FalsehoodsAboutTime.com
                    </li>
                    <li>
                        UTC is enough for everyone, right ? - Zach Holman
                        https://zachholman.com/talk/utc-is-enough-for-everyone-right
                    </li>
                    <li>https://www.timeanddate.com/</li>
                    <li>Wikipedia</li>
                    <li>JavaDoc</li>
                </ul>
            </section>
        </section>
        <section>
            <h1>Il te reste 5 min</h1>
        </section>
        <section>
            <h1>Game over !</h1>
        </section>
    </div>
</div>

<script src="js/reveal.js"></script>

<script>
    // More info about config & dependencies:
    // - https://github.com/hakimel/reveal.js#configuration
    // - https://github.com/hakimel/reveal.js#dependencies
    Reveal.initialize({
        hash: true,
        width: "80%",
        height: "95%",
        margin: 0,
        dependencies: [
            {src: 'plugin/markdown/marked.js'},
            {src: 'plugin/markdown/markdown.js'},
            {src: 'plugin/highlight/highlight.js'},
            {src: 'plugin/notes/notes.js', async: true}
        ]
    });
</script>
</body>
</html>
